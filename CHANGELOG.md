# 更新日志

## v2.0.4 - 2025-12-10

### 布局优化

**结果页面字段布局调整**
- ✅ 收费员和监控员并排显示
- ✅ 当前班次和免费原因并排显示
- ✅ 这两排放到金额下方
- ✅ 优化字段顺序，逻辑分组更清晰

**空间利用提升**
- ✅ 减少2行垂直空间
- ✅ 页面更加紧凑
- ✅ 减少滚动需求

**用户体验提升**
- ✅ 字段分组更加清晰
- ✅ 相关信息并排显示，便于对比
- ✅ 页面布局更加合理

---

## v2.0.3 - 2025-12-10

### OCR识别优化

**车型识别优化**
- ✅ 修改正则表达式，支持识别包含空格的完整车型信息
- ✅ 可以正确识别"一型 客车"、"二型 货车"等完整车型
- ✅ 使用前瞻断言确保准确识别字段边界

**通行时间优化**
- ✅ 使用当前时间替代图片中的入口时间
- ✅ 记录识别时的实时时间，格式：YYYY-MM-DD HH:mm:ss
- ✅ 准确反映车辆通行登记时间

**AI提示词优化**
- ✅ 明确要求识别完整的车型信息（型号+类型）
- ✅ 移除时间字段识别要求
- ✅ 提高识别准确性

### 数据质量提升

- 车型信息更加完整
- 时间记录更加准确
- 符合业务需求

---

## v2.0.2 - 2025-12-10

### UI/UX优化

**图片预览优化**
- ✅ 首页图片预览高度从400px减少到250px
- ✅ 结果页面图片高度从300px减少到200px
- ✅ 用户可以第一时间看到"开始识别"按钮
- ✅ 减少滚动需求，提升操作便利性

**按钮可见性优化**
- ✅ 返回按钮添加蓝色圆形背景和阴影效果
- ✅ 重新识别按钮背景色改为明显的蓝色（#1492ff）
- ✅ 按钮文字使用白色，提高对比度
- ✅ 所有按钮清晰可见，易于识别和点击

### 用户体验提升

- 图片大小适中，不占用过多空间
- 按钮视觉层次清晰
- 操作更加流畅便捷
- 整体视觉效果更好

---

## v2.0.1 - 2025-12-10

### 重要修复

**拍照功能优化**
- 🔧 拍照按钮改用 `Taro.chooseMedia` API
- ✅ 修复拍照按钮无法唤醒相机的问题
- ✅ 确保拍照和选择图片功能完全独立
- ✅ 提升跨平台兼容性（微信小程序/H5）

### 技术改进

- 使用更可靠的 `chooseMedia` API 替代 `chooseImage`
- 优化相机调用体验
- 更新功能说明文档

---

## v2.0.0 - 2025-12-10

### 重大更新：后台管理系统

1. **完整的HTML后台管理系统**
   - 独立的Web后台管理界面
   - 响应式设计，支持PC和移动端访问
   - 现代化UI设计，操作流畅

2. **收费站管理**
   - 添加/编辑/删除收费站
   - 收费站编码和名称管理
   - 收费站与班组的层级关系

3. **班组管理**
   - 添加/编辑/删除收费班组
   - 班组归属收费站
   - 班组编码和名称管理

4. **收费员管理**
   - 添加/编辑/删除收费员
   - 收费员归属班组
   - 工号和姓名管理
   - 自动关联到收费站

5. **监控员管理**
   - 添加/编辑/删除监控员
   - 监控员归属收费站
   - 工号和姓名管理

6. **班次时间设置**
   - 白班时间设置（默认：7:30-15:30）
   - 中班时间设置（默认：15:30-23:30）
   - 夜班时间设置（默认：23:30-7:30）
   - 支持自定义修改时间段
   - 支持跨天班次（如夜班）

7. **记录管理与导出**
   - 查看所有登记记录
   - 搜索和筛选功能
   - 导出Excel格式
   - 导出PDF格式
   - 统计数据展示（总记录、今日、本月）

### 小程序端增强

1. **人员选择优化**
   - 收费员改为下拉选择（从后台数据库读取）
   - 监控员改为下拉选择（从后台数据库读取）
   - 显示工号和姓名信息

2. **班次自动识别**
   - 根据当前时间自动显示班次
   - 支持白班/中班/夜班识别
   - 班次时间可在后台自定义

3. **数据库结构优化**
   - 新增5个后台管理表
   - 完善的关联关系
   - 优化查询性能

### 技术改进

1. **配置脚本**
   - 自动配置后台管理系统
   - 从.env读取Supabase配置
   - 一键部署脚本

2. **API扩展**
   - 新增收费员列表查询API
   - 新增监控员列表查询API
   - 新增班次设置查询API
   - 新增班次自动判断函数

3. **文档完善**
   - 后台管理系统使用说明
   - 数据库表结构文档
   - 部署指南

---

## v1.1.0 - 2025-12-10

### 新增功能

1. **首页拍照功能**
   - 新增独立的拍照按钮，可直接调用摄像头拍照
   - 优化图片选择流程

2. **登记信息页增强**
   - 新增免费原因下拉选择器（紧急车/军警车/应急车/旅游包车）
   - 新增收费员输入框
   - 新增监控员输入框
   - 新增重新识别按钮（替换原空白按钮）
   - 新增自定义返回按钮（左上角"<"图标）

3. **历史记录页交互优化**
   - 支持点击记录查看详情
   - 显示免费原因标签
   - 显示收费员和监控员信息
   - 编辑模式下隐藏图片预览

### 功能优化

1. **应用名称更新**
   - 从"智票通"更名为"免费车登记"
   - 更新所有相关文案和说明

2. **文案优化**
   - 移除所有"票据"相关字样
   - 统一使用"车辆信息"、"登记"等术语
   - 优化用户引导文案

3. **数据库结构**
   - 新增 free_reason 字段（免费原因）
   - 新增 toll_collector 字段（收费员）
   - 新增 monitor 字段（监控员）

### 技术改进

1. **页面配置**
   - 登记信息页使用自定义导航栏
   - 优化页面标题和导航体验

2. **代码质量**
   - 通过所有代码检查
   - 优化类型定义
   - 改进错误处理

---

## v1.0.0 - 2025-12-06

### 初始版本

- 车辆信息识别功能
- 历史记录管理
- 个人中心
- 数据库集成
